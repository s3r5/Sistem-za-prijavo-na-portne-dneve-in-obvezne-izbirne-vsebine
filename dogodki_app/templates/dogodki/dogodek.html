{% extends 'dogodki/base.html' %}
{% block title %}{{ dogodek.naslov }} · {{ block.super }}{% endblock title %}
{% block main %}
<div class="card mb-3">
	<div class="card-header">
		<i class="fas fa-info-circle"></i> Podatki o dogodku
		<a href="{% url "uredi_dogodek" dogodek.pk %}" class="btn btn-primary btn-sm float-right"><i class="fas fa-edit"></i> Uredi</a>
	</div>
	<div class="card-body row">
		<div class="col-md-7">
			<h3>{{ dogodek.naslov }}</h3>
			<p class="mb-0">{{ dogodek.opis }}</p>
		</div>
		<div class="col-md-5">
			<div><i class="far fa-calendar-alt"></i> Rok prijave: {{ dogodek.rok_prijave }}</div>
			<div><i class="fas fa-list"></i> {{ dogodek.skupine.count }} {{ dogodek.skupine.count | pluralize:"skupina,skupin" }}</div> <!-- TODO: pluralize_pl -->
			<div><i class="fas fa-users"></i> {{ dogodek.število_mest }} mest, {{ dogodek.število_navoljo }} na voljo</div>
			<div class="text-{{ povabilo.skupina|yesno:"success,danger"}}"><i class="fas fa-list"></i> Skupina: {{ povabilo.skupina.naslov|default:"niste še prijavljeni!" }}</div>
		</div>
	</div>
</div>

<div class="card-columns">
{% for skupina in skupine %}
	<div class="card{% if skupina.polna %} text-danger{% endif %}{% if skupina.moja %} text-success border-success{% endif %}">
		<div class="card-header d-flex justify-content-between">
			<span>
				<i class="fas fa-users"></i> {{ skupina.naslov }} 
			</span>
			<span>
				<span class="badge badge-{{ skupina.polna|yesno:"danger,primary" }}">{{ skupina.število_prijavljenih }} / {{ skupina.število_mest }}</span>
			</span>
		</div>
		<ul class="list-group list-group-flush">
	{% for prijava in skupina.prijavljeni %}
		{% if prijava.jaz %}
			<li class="list-group-item list-group-item-success d-flex justify-content-between">
				{{ prijava.uporabnik }}
				<button type="button" class="btn btn-sm btn-danger">Odjava</button>
			</li>
		{% else %}
			<li class="list-group-item list-group-item-light">{{ prijava.uporabnik }}</li>
		{% endif %}
	{% endfor %}
	{% if not skupina.moja %}
		{% if skupina.polna %}
			<li class="list-group-item list-group-item-light small bg-light text-danger">Ni več prostih mest!</li>
		{% elif not povabilo.skupina %}
			<li class="list-group-item bg-light">
				<button type="button" class="btn btn-block btn-primary">Prijava</button>
			</li>
		{% endif %}
	{% endif %}
		</ul>
	</div>
{% endfor %}
</div>
{% endblock main %}
